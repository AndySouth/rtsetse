<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Andy South" />

<meta name="date" content="2015-12-15" />

<title>movement in rtsetse</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">movement in rtsetse</h1>
<h4 class="author"><em>Andy South</em></h4>
<h4 class="date"><em>2015-12-15</em></h4>
</div>


<p><a href="https://github.com/AndySouth/rtsetse">rtsetse</a> is an R package that simulates tsetse fly populations on a spatial grid of different vegetation types to enable investigation of tsetse control.</p>
<p>Movement of tsetse flies is represented to replicate the methods used in <a href="http://www.tsetse.org/trick/index.html">Hat-trick</a> an existing Excel based tsetse simulation.</p>
<p>This document shows how the rtsetse code works and can be used to represent movement at different levels of detail. You may ignore the grey code boxes if you want to see what the code can do rather than how it does it.</p>
<p>Flies are moved from each cell to it’s 4 cardinal neighbours (NESW) and the following mechanisms are represented (ordered by increasing detail). These will be covered as separate sections in this document.</p>
<ol style="list-style-type: decimal">
<li>A set proportion move per time step</li>
<li>Reflecting boundaries (of the whole area)</li>
<li>Avoidance of ‘no-go’ areas</li>
<li>Movement rates based on vegetation type</li>
<li>Movement to poorer vegetation reduced</li>
<li>Adding all the movement mechanisms together</li>
</ol>
<p>First load the rtsetse package after installing from github if necessary.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#require(devtools)    </span>
<span class="co">#install_github('AndySouth/rtsetse', build_vignettes=TRUE)</span>
<span class="kw">require</span>(rtsetse)
<span class="co">#these packages are used for plots in this document</span>
<span class="kw">require</span>(raster)
<span class="kw">require</span>(sp)
<span class="kw">require</span>(RColorBrewer)</code></pre>
<p>The movement functions in rtsetse, accept a spatial matrix (y,x) defining the population of tsetse flies (of a particular age and gender). The function can be called repeatedly for different ages and sexes, allowing the movement rates to be age and sex dependent. For simplicity the examples shown here will just be for a single age and sex.</p>
<div id="a-set-proportion-move-per-time-step" class="section level3">
<h3>1. A set proportion move per time step</h3>
<p>This example shows setting up a small test grid and running it for a few days with first a high and then a low movement proportion.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#set dimensions of the spatial grid</span>
nY &lt;-<span class="st"> </span>nX &lt;-<span class="st"> </span><span class="dv">5</span>
nDays &lt;-<span class="st"> </span><span class="dv">3</span>
<span class="co">#create array to store grids over time</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(nY, nX, nDays))
<span class="co">#populate central cell of starting grid on day1</span>
a[<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>

<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVeg(a[,,day-1], pMove=pMove)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove)  
}

<span class="co">#quick way of displaying population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#repeat with lower movement proportion</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.4</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVeg(a[,,day-1], pMove=pMove)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove)  
}

<span class="co">#quick way of displaying population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="reflecting-boundaries-of-the-whole-area" class="section level3">
<h3>2. Reflecting boundaries (of the whole area)</h3>
<p>Increasing the number of days we get to see what happens with flies at the boundaries of the simulated area. Each cell receives back the same number of movers as it gives out. This represents a likely situation where the vegetation and fly population neighbouring the boundary cells is similar to that in them. There is also an option within rtsetse to represent ‘island’ movement where no movers come back in from outside the area.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#set dimensions of the spatial grid</span>
nY &lt;-<span class="st"> </span><span class="dv">5</span>
nX &lt;-<span class="st"> </span><span class="dv">4</span>
nDays &lt;-<span class="st"> </span><span class="dv">12</span>
<span class="co">#create array to store grids over time</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(nY, nX, nDays))

<span class="co">#populate central cell of starting grid on day1</span>
a[<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVeg(a[,,day-1], pMove=pMove)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove)    
}

<span class="co">#quick way of displaying population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /> You can see that the reflecting movement results in the population becoming distributed equally over the grid.</p>
</div>
<div id="avoidance-of-no-go-areas" class="section level3">
<h3>3. Avoidance of ‘no-go’ areas</h3>
<p>To avoid ‘no-go’ areas the code is identical to the above with the addition of a matrix for no-go areas. In this example the top row is set as a no-go area. You should be able to see that row remains unoccupied in the spread maps below.</p>
<pre class="sourceCode r"><code class="sourceCode r">nY &lt;-<span class="st"> </span><span class="dv">5</span>
nX &lt;-<span class="st"> </span><span class="dv">4</span>
nDays &lt;-<span class="st"> </span><span class="dv">5</span>

<span class="co">#create array to store grids over time</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(nY, nX, nDays))

<span class="co">#creating empty no-go matrix</span>
mNog &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span>, <span class="dt">dim=</span><span class="kw">c</span>(nY,nX))
<span class="co">#set first row to nogo (0)</span>
mNog[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="dv">0</span>

<span class="co">#populate central cell of starting grid on day1</span>
a[<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVeg(a[,,day-1], pMove=pMove, mNog=mNog)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mNog=</span>mNog)    
}

<span class="co">#display population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="movement-rates-based-on-vegetation-type" class="section level3">
<h3>4. Movement rates based on vegetation type</h3>
<p>Within the Hat-trick tsetse simulation flies are assumed to move at different rates in different vegetation types. Flies move more quickly out of cells containing the vegetation types associated with faster movement. In rtsetse this is accomodated by allowing a movement multiplier to be applied to each cell. Where the movement multiplier is greater than 1 flies will move out faster, where it is less than 1 (but still greater than 0) flies will move out more slowly.</p>
<p>We can demonstrate this with a first simple example where a vegetation matrix is created with lower movement in the 2nd row, and the simulation is started with a uniformly populated grid. In the spread maps we can see this row increases in population while those around it decrease.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#create array to store grids over time</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(nY, nX, nDays))

<span class="co">#creating empty vegetation matrix</span>
mVegMove &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span>, <span class="dt">dim=</span><span class="kw">c</span>(nY,nX))
<span class="co">#set 2nd row to lower movement</span>
mVegMove[<span class="dv">2</span>,] &lt;-<span class="st"> </span><span class="fl">0.8</span>

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVeg(a[,,day-1], pMove=pMove, mVegMove=mVegMove)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegMove=</span>mVegMove)  
}

<span class="co">#display population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>In a second example we can increase movement from the 2nd row and in the maps see that the population now becomes lower in that row.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>In a third example we can keep the higher movement in the 2nd row and add lower movement in the 4th row. As expected the population declines in the former and increases in the latter.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAADACAMAAADsiSGEAAAA1VBMVEUAAAAAAC4AADoAAFIAAGYAM3MAOpAARBsAWyQAXJEAZrYCbi0Wfzsmjkc3oVU6AAA6AC46ADo6AFI6AGY6My46M3M6OgA6OpA6ZmY6gK86kLY6kNtOsWNmAABmAC5mADpmAGZmo8xmtv9nvW+CyoKQMwCQOgCQOjqQXACQgFKQxZGQxcyQ2/+Y1ZSv36m2XAC2ZgC2xXO25cy2///F6L7U7s7bgC7bkDrbtrbb5czb///l9eDu+Or/o1L/tmb/xXP/25D/5ZH/5a//5cz//7b//9v///+eS9JbAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI3UlEQVR4nO3diXbbRBiGYZWmOxCWsoTiLoGEJS0uBBxom8Vx4vu/JDSSbCseraOZ6a8/73eAhvaID0mPtUWTSZaECE7ysf8HCGkKQInoAJSIDkCJ6ACUiA5AiegAlIgOQInoAJSIDkCJ6ACUiA5AiegAlIgOQInoAJSIDkCJ6ACUiA5AiegAlIgOQInoAJSIDkCJ6DgDTcitS8uu90Ryy5nzgovwoUNSxWIN9EFlAErHR60AqL1F6BBUAVB7i9AhqAKg9hahQ1CFTqCnd46qfvv8q7+6bBH3jsuD9LZyL2zHYpYk1avnsSPN9N5/ISvmE3ML/qh94VsEdD65Gxbo5UH6e7NOW925YzFLV6IOla8O89tJWKDnX3T5kC1uE9DTJAkM9Hz31SIXFK5jPtkzn4SwH4LsABcW6GmnfbFQCNScAX8zW2SankJSMFOzL2ePUp973TbKgI4sXQ5vAzt8Aa3vmN371Q/QuopZhzXIO1a7/mFlRgd0as6A5iLNbIlZ+qtReXlgDm0dP7XDOvI/Ddwx83OKr+9IT8B+rkFrK6ZPu16ur3a9DqD5WXZ652j+/Cj/t/nk1eqCxxPQxg5zpA7ccerpRqy+4/Jgz89NUm3FfGL+89Mum2q163UAzQ0WZ9nT1Ulllm9sT0CbO7rcIw3sSAH50FPfYf72ArR5NTrtEGVAZ+stkl783P3TfIDTrVB8Uj0BberodPwc2LHwdJ1b25EdqL0AbVmN/ADb0rHa9Z2AXnx9fOPLi90kuf9OEND1RzZb9+wf8+e/Pz8q/WHrFhnQMevmc1CHSac969wxK14Uau0YvBodnjX1Ano12Tm+8eXZYzdnwYAWT3ruHGWb5tRs48uDp8XBwOs1aFXHrH2fDu3I/6DTudG5I4vHa9Bhq9ED6Eny/eoIWnz59pkwoPmdYpJ/ZOeT7IC2Pqz5uouv6zjf7Xb8HNKRwTE3MSE7Fgtf30mqXw1zqe77Junfd+tTfP7l9S+vpQFdP3jLviM4Nddq6xOJ9+egWx3FqdHvc1BrPaZdTr4DOxbevtU5fDVagN58bXnrGvTqxbfJJw5G474scv5N+6YubxE6BFVsgD6pTPNN0sWXr5dXL4+XfRMX6KzribfYInQIqhgG1OTqRf9DKGOSSOeMC+jP4ZP8GD5KOqKsxhCgZzvpaf67mM9BASqpQyjQ/NlS9uVJkuz0vwQFqJIOeUA9BaA6OgBqLQhQSR0AtRYEqKQOgFoLAlRSR1Sgn1YGoGG2uo4OgFoLAlRSB0CtBQEqqQOg1oIAldQBUGtBgErqAKi1IEAldQDUWhCgkjrkAd1+m+n6kO/FO211HR3igFqD5t4+Nn8BtPdW19ERFehnlWkeNGfeBS0dVAHaeavr6JAAtPxWszVo7qJACtC+W11HhwSgN4Fsj0kCqONW19EBUICK7gAoQEV3iAfKTZLrVtfRIR4oj5lct7qODqFAS4PmriY8qHfa6jo65AH1FNlA/wmf5H34JB+CJ4yOrV2++vXzygAUoADtsSBAAQpQgALUdUGAAhSgAAWo64IABShAAQpQ1wUBClCAAlQi0OZvNIUp7b8gQAHaBHT9skgxWi76THMABWgD0M2gueI1pugzzQEUoPVAN4PmVi+CRp9pDqAAvQm0etBc8bZy/JnmAArQLtegBdD4M80BFKA9gMafaQ6gAO0B1Hypb9AcQMcPtDRaDqAADZk10J8qU/ccNH/MpHOmOYCOHKh5tlSMllM50xxAxwvUc2n/BQEKUIACFKCuCwIUoAAFKEBdF4wBVEvHm+CJUPEGoNaO1dIRAU/4CoDaO1ZLRwQ84Ss2QGvW0hPJLWfOC8bYsVo6IuAJXwFQe5W1dETAE74CoPYqa+mIgCd8RU+g22OSrjVO5KWlIwKe8BX9gFpjklT+hGUtHRHwhK/oBdQak6TzZ9Rr6YiAJ3xFL6DWmCSds3xo6YiAJ3xFK9DyoDl7yAdABXdEwBO+wvEmCaAj6IiAJ3zFBmjzHwN0fB0R8ISvcATKTdIIOiLgCV/hCJTHTCPoiIAnfIUL0NKYJJUTeWnpiIAnfEVPoJ4C0BgdEfCErwCovWO1dETAE74CoPaO1dIRAU/4CoDaO1ZLRwQ84SsAau9YLR0R8ISv2AD9ozIAHW9HBDzhKwBq71gtHRHwhK8AqL1jtXREwBO+AqD2jtXSEQFP+AqA2ju2ekozr0mehE/yMHiSB+EDUICqAVoaInexm03gpXIiL4COFejm3aWrybPlidaJvAA6UqCltz9XbyqrnMgLoCKB/l2Z8pik0vvzqifyAuiYgJZ0lOeemewvT5J9nRN5AXT8QM3d0Q+H+zon8gKoAqDLpd6JvAA6UqBbQ+TUTuQF0JECLT9mMnfwWifyAuhYgRZD5MyzpbP8Ab3KibwAOlag3gJQgAIUoLqA1kzo44nkljPnBQEKUIACFKCuCwIUoAAFKEBdFwQoQAEKUIC6LghQgAIUoCMFao9JUjmRF0BFAn1fmZYxSSp/wjJARwrUHpOk82fUA3SkQO0xSTpn+agePug1NW8+eE2Ejiir0QK0etBcMSYJoAAN3tECtKSjYkwSQAEausMN6HLJKR6gwoDaY5J03iQBVFBFH6D2mCSdj5kAKqiiF1B7TJLKibwAKqhiA/RDZW7jtzoBKqgCoAAVXQFQgIquAChARVcAFKCiKwAKUNEVAAWo6AqAAlR0BUABKrpiA9QzpWZnzgsCtPueVVEBUICKrugF9OagOTN7gsqJvAAqqKIX0PKguf3lSYpV5UReABVU0QfobZnIC6CCKlqBVo9Juj7cX57df6dzIi+ACqrocwQtD/BIL0fTa0+dE3kBVFCFI9DsBzfsHOucyAuggiocgZatRh00R25dWnZ9SUfFTVJsoIQ0ZPOY6fowO8VHn8iLkIaUBs0VD+pjT+RFSIwAlIgOQInoAJSIDkCJ6ACUiA5AiegAlIgOQInoAJSIDkCJ6ACUiA5AiegAlIgOQInoAJSIDkCJ6ACUiA5AiegAlIgOQInoAJSIzv97259P0f+INAAAAABJRU5ErkJggg==" /></p>
<p>Now what happens if we apply this movement to the representation of a real landscape ? Lets first use the Serengeti map dataset stored in rtsetse (copied from Hat-trick). The cell size in this map is 1km, 80% of the flies are simulated as moving to one of the four neighbouring cells per day, thus representing a reasonable mean displacement of 800m per day seen in Savannah tsetse (Vale et al. 1984).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#get the vegetation map</span>
mVegCats &lt;-<span class="st"> </span><span class="kw">rtReadMapVeg</span>( <span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;vegTanzaniaSerengetiTorr1km.txt&quot;</span>, <span class="dt">package=</span><span class="st">&quot;rtsetse&quot;</span>))
<span class="co">#plot veg map</span>
<span class="kw">rtPlotMapVeg</span>(mVegCats)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>We can convert the vegetation categories to movement multipliers using the suggestions from Hat-trick for flies preferring Savannah and run the simulation. Note that the percentage of flies moving out of cells per day seems very high (88% in grass, 80% in savannah and 68% in woodland). Is this reasonable ?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#convert vegetation categories to movement multiplier values</span>
dfMoveByVeg &lt;-<span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">code=</span><span class="kw">c</span>(<span class="st">&quot;D&quot;</span>,<span class="st">&quot;T&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;G&quot;</span>,<span class="st">&quot;N&quot;</span>),<span class="dt">move=</span><span class="kw">c</span>(<span class="fl">0.85</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="dv">1</span>, <span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="dv">0</span>))
mVegMove &lt;-<span class="st"> </span><span class="kw">rtSetGridFromVeg</span>( <span class="dt">mVegetation=</span>mVegCats, <span class="dt">dfLookup=</span>dfMoveByVeg )

nDays &lt;-<span class="st"> </span><span class="dv">12</span>

<span class="co">#create array to store grids over time, set dimensions from the veg grid</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">dim</span>(mVegMove), nDays))

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVeg(a[,,day-1], pMove=pMove, mVegMove=mVegMove)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegMove=</span>mVegMove) 
}

<span class="co">#display population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#to look more closely at the final day</span>
<span class="kw">spplot</span>( raster::<span class="kw">raster</span>(a[,,nDays], <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>Remember that the maps above are just for a single age and sex class with movement only and no births and deaths.</p>
</div>
<div id="movement-to-poorer-vegetation-reduced" class="section level3">
<h3>5. Movement to poorer vegetation reduced</h3>
<p>The results above also do not include any change in behaviour at vegetation boundaries. Hat-trick allows for movements to less preferred vegetation types to be decreased. The six potential vegetation types in Hat-trick are ordered by decreasing density of vegetation.</p>
<ol style="list-style-type: decimal">
<li>Dense Forest</li>
<li>Thicket</li>
<li>Open Forest</li>
<li>Savannah</li>
<li>Bush</li>
<li>Grass</li>
</ol>
<p>The default names can be changed, but the ordering by density needs to remain.</p>
<p>The user chooses a preferred (‘best’) vegetation type for the flies being considered then movement is reduced if it would result in a decline in preference. As explained in Hat-trick :</p>
<blockquote>
<p>If the fly is in a certain vegetation type and is headed to the same vegetation type, or to one that is better, ie, the best or a type that is closer to the best type, then the fly will keep going with no adjustment to the evacuation rate. Otherwise, the fly must be headed to a vegetation type that differs more markedly from the best than the one the fly is in. The fly will then tend to turn back, with a probability that is greater the more the vegetation type to which it is headed differs from the best. In deciding whether vegetataion is closer to the best, one that is X categories denser than the best is regarded as no worse than one that is X categories less dense than the best.</p>
</blockquote>
<p>Movement resulting in a decline in preference of 1, 2, 3, 4, 5 categories is set to 30%, 10%, 3%, 1%, &amp; 0.3% respectively of what it would have been otherwise.</p>
<p>Here is a first simple test with just 2 vegetation types.</p>
<!-- note reduced fig.width & fig.show='hold' above to fit 2 plots side by side -->
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#create very simple test veg map</span>
nY &lt;-<span class="st"> </span><span class="dv">5</span>
nX &lt;-<span class="st"> </span><span class="dv">4</span>
<span class="co"># G for Grass, S for Savannah</span>
<span class="co">#vertical split</span>
<span class="co">#m2 &lt;- array(&quot;G&quot;, dim=c(nY,nX))</span>
<span class="co">#m2[1:(nY*nX/2)] &lt;- &quot;S&quot;</span>
<span class="co">#horizontal split</span>
m2 &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="st">&quot;G&quot;</span>, <span class="dt">dim=</span><span class="kw">c</span>(nY,nX))
m2[<span class="dv">1</span>:<span class="kw">round</span>(nY/<span class="dv">2</span>),] &lt;-<span class="st"> &quot;S&quot;</span>

nDays &lt;-<span class="st"> </span><span class="dv">99</span>

<span class="co">#create array to store grids over time, set dimensions from the veg grid</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">dim</span>(m2), nDays))

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>
<span class="co">#set preferred vegetation type to Savannah(index=4)</span>
iBestVeg &lt;-<span class="st"> </span><span class="dv">4</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#because mVegMove is not specified here, only the vegetation difference effect operates</span>
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVegBoundary(a[,,day-1], pMove=pMove, mVegCats=m2)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegCats=</span>m2, <span class="dt">iBestVeg=</span>iBestVeg)  
}

<span class="co">#plot vegetation map</span>
<span class="kw">rtPlotMapVeg</span>(m2)

<span class="co">#plot final day</span>
<span class="kw">spplot</span>( raster::<span class="kw">raster</span>(a[,,nDays], <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAhFBMVEUAAAAAADoAAGYAOpAARBsAWyQAZrYCbi0Wfzsmjkc3oVU6AAA6ADo6AGY6OgA6OpA6ZmY6kNtOsWNmAABmADpmAGZmtv9nvW+CyoKQOgCQOjqQ2/+Y1ZSv36m2ZgC2///F6L7U7s7bkDrbtrbb///l9eDu+Or/tmb/25D//7b//9v///8tP3vcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEKElEQVR4nO3dWVMaQRRA4TH7vmnMYqIJMQHk//+/MCrNCC2HOw20FOeUDz6l5n41mcEqr91MbGVN7Qt46AkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBOWBmn0P5igHerrfJaAn2QQSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCGpWzyGQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFAEaPS6aU5vvr361jy6OCyg59m6Q4+PTyfDo7Pr78+ftV8C3QEaPr6c3jnXt9D45GwyertwCx080OwumtbitEgCLf4a1WB6Fwl0/x00uH0yC5QHGtw+ogXKAw3Sm92HdA5o9GZ+y/iazwCdXz+vTyfnH9u3mR8Ucw/plQkkkEDLCQQJBAkEJaAX2QQSCNo+UP43s/YmgSCBIIEggSCBIIEggSCBIIEggSCBIIGgBPQym0ACQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBCehVNoEEggSCBIIEggSCBIIEggSCYkBpR6zdEL/ZzhSo0/h4tgM1XFwWE2jaoPkwu4PanTGBWqDu1vOfy9l/savvZxmKgwS6O+0MaHzyrjlaNBJoDtSur44/r7fUW3vCwhLQp2z3vcUmk7XXwmtPWJhAUD+g4fR1P3p/WJ+D1gdqX/GDZu218NoTFhYDWplA/YAC/8JDTCBIIEggSCBIIEggSCBIIEggKAF9ySaQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAUAL6mk0ggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBoAT0I5tAAkECQTGgtA4VOAx7o5e7+0JA863nwCmZm73enRcBmm89R85Z3fgl7zYCym89R07q3dKF76p+zyCBNgj0b78TCOoHFHlI156wsJ6fgwKv+doTFtYDKHgYdu0JC9v+jxq1JyxMICgB/cwmkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFAC+pVNIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaAE9DubQAJBAkECQQJBAkECQQJBAkECQQJBAkERoM6qc+Cs59oTFhYB6uxABc56rj1hYQGg7hZd4Kzn2hMWloD+ZusO3dnDjJz1XHvCwgiosxbeAYqc9Vx7wsL63UGRs55rT1hYP6Cbu+iwtp4ZaGHVWaBFoM5rPnLWc+0JC4sA3a46B896rj1hYREgSCCBBFpOIEggSCBIIEggqFk9h0ACQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBzcrpQn9wXSCBBFpOIEggSCBIIEggSCBIIEggSCBIIEggaPtA+x7MUQxkKYEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaD/Wkqj+Mzmj1oAAAAASUVORK5CYII=" /></p>
<p>Now trying with more vegetation types. <!-- note reduced fig.width & fig.show='hold' above to fit 2 plots side by side --></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#create very simple test veg map</span>
nY &lt;-<span class="st"> </span><span class="dv">6</span>
nX &lt;-<span class="st"> </span><span class="dv">4</span>

<span class="co">#create horiz stripes of habitat</span>
m2 &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(<span class="st">&quot;D&quot;</span>,<span class="st">&quot;T&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;G&quot;</span>), <span class="dt">dim=</span><span class="kw">c</span>(nY,nX))

<span class="co">#m2[1:round(nY/2),] &lt;- &quot;S&quot;</span>

nDays &lt;-<span class="st"> </span><span class="dv">12</span>

<span class="co">#create array to store grids over time, set dimensions from the veg grid</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">dim</span>(m2), nDays))

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.6</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#because mVegMove is not specified here, only the vegetation difference effect operates</span>
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVegBoundary(a[,,day-1], pMove=pMove, mVegCats=m2)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegCats=</span>m2, <span class="dt">iBestVeg=</span>iBestVeg)   
}

<span class="co">#plot vegetation map</span>
<span class="kw">rtPlotMapVeg</span>(m2)

<span class="co">#plot final day</span>
<span class="kw">spplot</span>( raster::<span class="kw">raster</span>(a[,,nDays], <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAhFBMVEUAAAAAADoAAGYAOpAARBsAWyQAZrYCbi0Wfzsmjkc3oVU6AAA6ADo6AGY6OgA6OpA6ZmY6kNtOsWNmAABmADpmAGZmtv9nvW+CyoKQOgCQOjqQ2/+Y1ZSv36m2ZgC2///F6L7U7s7bkDrbtrbb///l9eDu+Or/tmb/25D//7b//9v///8tP3vcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEmElEQVR4nO3diU7bQBRAUdOF7iuUltJCm9ImIf//fyUBJiaa+OaZwWMp9woJJFupfWRsVHn0moV11tQ+gLEnECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBC0G1Az9uA4Hx/oAf/CECWgZ9kEEggSCBIIEggSCBIIEggSCBIIEggSCBIIigDN3jTNyfrHp5e7fXSJveqVgJ5nax/+/OhkMT04W/08Pdz9o0vsVa8A0PT6krk6vbmEzj/t/tEl9qoXAW38t9nyKrru6vvZ7h9dYq96Ba6gZZObG8/8+H1zQEb7CDR5crH6Pnt7tph/udjto0vsVa8Q0KR91cyP4RLaP6C76+cmgTaBlr9Xt02vqWYf/DvoPtD56oF2snrET5rmCdyC9g+o70eX2KteAkECQQJBAkECQQnoRTaBBIIEggSCBIIEggSCBIIEguoD/R53AkECQQJBAkECQQnoZTaBBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEghLQq2wCCQQJBEWAWgvqrk6LvSddWwAKALUX1J0fLr8EugfUWlC3XKcxe1dmtU9tAYiA8gvqljilFrPUFoCCN+nbBXUCbQFKC+oEygKlBXUCZYHWC+q8SeeAWgvqfMzngNoL6uZH/qGYfYpFEmi/gF5nE0ggSCBIIKg+0M9xJxAkECQQJBAkECQQJBAkECQQJBCUgD5nE0ggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCAoAX3NJpBAkECQQJBAkECQQFAMKL1dX3BCXW0BKAQ0P7p7e7zghLraAlAEaNJ8vLuCCk6oqy0AEVB7Qd2fy7tfsZIT6moLQP3uQSUn1NUWgPoBlZxQV1sA6vkUW5QbwFZbAKoPlJ+AO5oS0LdsW4BKTqirLQD1ACo8oa62ABQDCiWQQAIJhAkECQQJBAkECQQJBAkECQQJBCWgH9kEEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCEpA3W/HCCTQlgSCBIIEggSCBIIEggSC6gP9GncCQTGg9KZ9wQl1tQWgENB6QV3B0TW1BaAI0HpBXcnhR7UFIALKL6grOT6rtgDUdB/nlnuQQJubBWq6NwvUdG/eANrHm3T35g2gfXzMd29uAxWeUDfk2fYoBhRKIIEEEggTCBIIEggSCBIISkDdMyIFEmhLAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEJ6G82gQSCBIIEguoD/Rt3AkECQQJBAkECQQJBAkECQQJBAkFN93HeO8nWKrqCE+qGPd9wEaDW6/UFJ9QNe77hAkDtBRoFJ9QNe77hAkCtJT4lJ9QNe77hCKi14rAFVHJC3bDnG67fFVRyQt2w5xuuH9CyUgvqhj3fcD1v0gJtbF61fsyXnFA37PmGiwDdrqIrPKFu2PMNFwEKJpBAAgmECQQloIecpEACCbQtgSCBIIEggSCBIIEggSCBIIEggSCBoPpAYw+O89GB9jiBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIGg//hnC5E4XtK1AAAAAElFTkSuQmCC" /> The above plot shows accumulation of flies in the preferred habitat type as expected, and progressively fewer flies in the vegetation types that are more different from the preferred. Changing the order of the rows and the effect remains as expected.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#create very simple test veg map</span>
nY &lt;-<span class="st"> </span><span class="dv">6</span>
nX &lt;-<span class="st"> </span><span class="dv">4</span>

<span class="co">#create horiz stripes of habitat</span>
<span class="co">#m2 &lt;- array(c(&quot;D&quot;,&quot;T&quot;,&quot;O&quot;,&quot;S&quot;,&quot;B&quot;,&quot;G&quot;), dim=c(nY,nX))</span>
<span class="co">#change order</span>
m2 &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;T&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;G&quot;</span>,<span class="st">&quot;B&quot;</span>), <span class="dt">dim=</span><span class="kw">c</span>(nY,nX))

nDays &lt;-<span class="st"> </span><span class="dv">12</span>

<span class="co">#create array to store grids over time, set dimensions from the veg grid</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">dim</span>(m2), nDays))

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.6</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#because mVegMove is not specified here, only the vegetation difference effect operates</span>
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVegBoundary(a[,,day-1], pMove=pMove, mVegCats=m2) </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegCats=</span>m2, <span class="dt">iBestVeg=</span>iBestVeg)  
}

<span class="co">#plot vegetation map</span>
<span class="kw">rtPlotMapVeg</span>(m2)

<span class="co">#plot final day</span>
<span class="kw">spplot</span>( raster::<span class="kw">raster</span>(a[,,nDays], <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAhFBMVEUAAAAAADoAAGYAOpAARBsAWyQAZrYCbi0Wfzsmjkc3oVU6AAA6ADo6AGY6OgA6OpA6ZmY6kNtOsWNmAABmADpmAGZmtv9nvW+CyoKQOgCQOjqQ2/+Y1ZSv36m2ZgC2///F6L7U7s7bkDrbtrbb///l9eDu+Or/tmb/25D//7b//9v///8tP3vcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEIElEQVR4nO3d2VLbMBhAYdN936DpQhtalzYJfv/3axwSxWGUnMiIyDM+Z7jgghmUb4TFMj+qGjtYVXoBQ08gSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIOg4oGrowTofHujlsAtAT6IJJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAUgJ5GE0ggSCBIIEggSCBIICgFaP66qia37958qx5dCbQLtDifNLOzy9X702ftm0A7QLPH18uds9pCi4vLZv4WttA4gO78+bDdRctanBZJoLsvsl7uIoH2A9XrJ7NAcaB6/YgWKA5Uh5N9jA/p59G6L3L+ZrtlRnjMM9B0daBNmunH9jQb3TeKDJSaQAIJJBAmECQQJBBUHujXsBMIEggSCBIIEggKQC+iCSQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAUgA7/Tl8ggfYkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEBSAXkUTKA0ojEC1A9C3w4cCdVqcb0Z8ZjQLNUqguvqw2UHtSJRALVB36vnP9eZL7OY7jGMmAB31UeXq9wxaXLyrzshozEDtdObic56Z1cQFn7qep1jTZJt6TlhsiQSC+gHNlsf9/H2e74MSF3zqegC1R3xdZZt6Tl7yaSv/o8Y9PsMpEggSCBIICkCfogkkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFIC+RBNIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIKg8UPwG3MEUgL5GE0ggSCBIIEggSCBIIEggSCBIICgNKIxDZbzrubQAlAS0nXrOeAlkaQEoBWg79ZzzGtHSAlAK0HbqOedFtKUFIALavQx7zEA/ou15SAsk0KZ+QGN8SCcBjfGYPx4o813PpQWgNKCkBBJIIIEwgSCBIIEggSCBIIGgAPQzmkACQQJBAkECQQJBAkECQQJB5YH+DjuBIIEggSCBIIGgAHT40gSBBNqTQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFAA+h1NIIEggSCBoBSgzqhzxrueSwtAKUCdGaiMdz2XFoASgLpTdBnvei4tACUAdeYwc971XFoAIqDO1HMHKOddz6UFoH47KOddz6UFoH5AbbmmnksLQD0f0gJFgDrHfM67nksLQClA61HnzHc9lxaA/FEDqg6vUyCBIIEggaDyQPF/ZD2YBIIEggSCBIIEggSCBIIEggSCBIIC0L9oAgkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFoPu8SIEEEmhfAkECQQJBAkECQQJBAkECQQJBAkECQeWBhh6s88GBRpxAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEDQfye0JnrgtmviAAAAAElFTkSuQmCC" /></p>
<p>Below the decreased movement to poorer vegetation types alone is applied to the Serengeti map.</p>
<pre class="sourceCode r"><code class="sourceCode r">nDays &lt;-<span class="st"> </span><span class="dv">12</span>

<span class="co">#create array to store grids over time, set dimensions from the veg grid</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">dim</span>(mVegCats), nDays))

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#because mVegMove is not specified here, only the vegetation difference effect operates</span>
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVegBoundary(a[,,day-1], pMove=pMove, mVegCats=mVegCats)</span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegCats=</span>mVegCats, <span class="dt">iBestVeg=</span>iBestVeg )  
}

<span class="co">#display population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#to look more closely at the final day</span>
<span class="kw">spplot</span>( raster::<span class="kw">raster</span>(a[,,nDays], <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>As expected flies accumulate in the preferred habitat (savannah in this case). There is particular accumulation where preferred habitat cells are surrounded by less preferred. Here is a confirmation check of what happens on the lower right corner of the Serengeti map.</p>
<!-- note reduced fig.width & fig.show='hold' above to fit 2 plots side by side -->
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#get the vegetation map</span>
mVegCats &lt;-<span class="st"> </span><span class="kw">rtReadMapVeg</span>( <span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;vegTanzaniaSerengetiTorr1km.txt&quot;</span>, <span class="dt">package=</span><span class="st">&quot;rtsetse&quot;</span>))
<span class="co">#subset SE corner</span>
m2 &lt;-<span class="st"> </span>mVegCats[<span class="dv">40</span>:<span class="dv">50</span>,<span class="dv">40</span>:<span class="dv">50</span>]

nDays &lt;-<span class="st"> </span><span class="dv">99</span>

<span class="co">#create array to store grids over time</span>
<span class="co">#set dimensions from the veg grid</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">dim</span>(m2), nDays))

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#because mVegMove is not specified here, only the vegetation boundary effect operates</span>
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVegBoundary(a[,,day-1], pMove=pMove, mVegCats=m2)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegCats=</span>m2, <span class="dt">iBestVeg=</span>iBestVeg )  
  }

<span class="co">#plot vegetation map</span>
<span class="kw">rtPlotMapVeg</span>(m2)

<span class="co">#plot final day</span>
<span class="kw">spplot</span>( raster::<span class="kw">raster</span>(a[,,nDays], <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,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" /> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAhFBMVEUAAAAAADoAAGYAOpAARBsAWyQAZrYCbi0Wfzsmjkc3oVU6AAA6ADo6AGY6OgA6OpA6ZmY6kNtOsWNmAABmADpmAGZmtv9nvW+CyoKQOgCQOjqQ2/+Y1ZSv36m2ZgC2///F6L7U7s7bkDrbtrbb///l9eDu+Or/tmb/25D//7b//9v///8tP3vcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAENElEQVR4nO3da1PTQBhA4eAF71cQLyhqRdvS////bFq6JGSTk2S2bCHnjB8YROj7zJowTJYtVtZZkfsFHHoCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQ2g4gEFI40EanzI8z0WeUX/Go395AHoSTSBBIIEggSCBIIEggSCBIIEggSCBIIC0NNoAg0BWrwqirPtm1dfi0c/BaoDLU/OVvOj883bF8flH4FqQPPHl+uVs1lCy9Pz1eJNWEIChcpVtK7EKZEEuv1js9l6FfUBena75gzpOJoakRqvqGfDVtDs+sosUBxodn2JFigONAt3drxITxJo8TosGbzNTxLoYnO9PltdfCjvZt3fKE4SqD2BBIqMVPtrgQQSSCCBBBJIIIEEEkigQwRK1145mgkEBaD4ehZIIEggSCBIIEggSCBIIEggSCBIIEggSCAoAL2IJpBAkEDQQQH1GjT+GAomkEACCSSQQAJ1A4WHx8utY9ttGwJVWp7sHo6eH9c8pgD0Mlpt9FnxfreCyofJBSqBqtuh/lzu/otdfTuveUwYqD74Dmh5+rY4ujES6DZQua9l+WnIbp+JAW1X0ZD9YgIJVAWar2/3i3fT+j6oP1B5i58VA/eLTQSoJYEESg00cooDTCBIICgAfYwmkECQQJBAkECQQJBAkECQQJBAkECQQJBAUAD6HE0ggaD7B9T8uWzk92A3/1nkg5qfKZJAAgkkkEACCSSQQAJ1A32JJpBAAgkkkEACCSTQpvAgOZ0vNlGgm/1idPBIr699LxoCdLNfDI+uyT1Wuggovl8MDz/KPVa6xl2Dpgj0PZpAAkHjgKZ4kR4ENMXbfH+gPueL5R4rXcOAWhJIIIHaEggSCBIIEggSCApAP6IJdFdAf+9rAkECQQJBAkECQQJBAkECQQJBAkECQQHoVzSBBIIEggSCBIIEggSC9gSUe6x0CQQJBAkECQQFoN/RBBIIEggSCBoCVNkDRcdn5R4rXUOAKg9H0/FZucdK1wCg6uP1dHxW7rHSNQCoskEDj8/KPVa6CKiyX6wChMdn5R4rXeNWEB6flXusdI0D2q6iju1QucdK18iLtEARoMptHo/Pyj1WuorukWqjX++B6nN81t0Osc+GALUmkEACtSUQJBAkECQQJBAkECQQJBAkEBSAGk/0bBJIIEggSCBIIEggSCBIIEggSCBIIEggSCCoaJux890CCbRLIEggSCBIIEggSCBIIEggSCBoT0APKBhpHJDVEwgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCPoPEEQs7kRihEoAAAAASUVORK5CYII=" /></p>
</div>
<div id="adding-all-the-movement-mechanisms-together" class="section level3">
<h3>6. Adding all the movement mechanisms together</h3>
<pre class="sourceCode r"><code class="sourceCode r">nDays &lt;-<span class="st"> </span><span class="dv">12</span>

<span class="co">#create array to store grids over time</span>
<span class="co">#set dimensions from the veg grid</span>
a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">dim</span>(mVegCats), nDays))

<span class="co">#fill starting grid on day1</span>
a[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#set proportion moving</span>
pMove &lt;-<span class="st"> </span><span class="fl">0.8</span>

for(day in <span class="dv">2</span>:nDays)
{
  <span class="co">#a[,,day] &lt;- rtMoveReflectNoGoVegBoundary(a[,,day-1], pMove=pMove, mVegCats=mVegCats, mVegMove=mVegMove)  </span>
  a[,,day] &lt;-<span class="st"> </span><span class="kw">rtMove</span>(a[,,day<span class="dv">-1</span>], <span class="dt">pMove=</span>pMove, <span class="dt">mVegCats=</span>mVegCats, <span class="dt">mVegMove=</span>mVegMove)  
}

<span class="co">#display population spread over time</span>
<span class="kw">spplot</span>( raster::<span class="kw">brick</span>(a, <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,<span class="dv">1</span>:nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAAA2FBMVEUAAAAAAC4AADoAAFIAAGYAM3MAOpAARBsAWyQAXJEAZrYCbi0Wfzsmjkc3oVU6AAA6AC46ADo6AFI6AGY6My46M3M6OgA6OpA6ZmY6gK86kLY6kNtOsWNmAABmAC5mADpmAGZmo8xmtv9nvW+CyoKQMwCQOgCQOjqQXACQgFKQxZGQxcyQ2/+Y1ZSv36m2XAC2ZgC2xXO25ZG25cy2///F6L7U7s7bgC7bkDrbtrbb5czb///l9eDu+Or/o1L/tmb/xXP/25D/5ZH/5a//5cz//7b//9v///8O+tpRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dDZ/ctpHmmThxHGu6vdnLJpfblpOYdHK7Fqnsxt2jW48kS5Y83/8bHQsPCigABZL9pqE0VT971K/1RxWeJl4Igs29mdmKrXnoApiZTZkJ1GzVZgI1W7WZQM1WbSZQs1WbCdRs1WYCNVu1mUDNVm0mULNVmwnUbNVmAjVbtZlAzVZtJlCzVZsJ1GzVZgI1W7WZQM1WbSZQs1WbCdRs1WYCNVu1mUDNVm0mULNVmwnUbNVmAjVbtZlAzVZtJlCzVZsJ1GzVZgI1W7XlAm3MzM62GTGdJdB3VzYDPLT/DwBgMf1GtUxzb/7X9/7BV03zzf39z39rfvW9CXS9gI8+gOME+v6pl+P7p9/cv/7ls/t/fEn/mUBXC/joAzhKoC+a/+2PoK8//2E8en7z/s/P4kHVBLpCwEcfwKxAZU/0//0g1EhHUXpKIj1LoK9+8Z328o//+s/5wp8M+OnbMao/XQagBnDbNHpclwKM9vzX/3MR/yrg7VOq+N9eD/Dux68W+D+1D0rH089/uKJA3z797IoC/enb8bXbC6VfC+B2LH1NVxcB0MvNNQX6478s+H2dA3g1lv7t0/kqOFWgL8bu6PUE+qpprinQH7/66zuo6AIAxf/bp3+iX8GC48OJAMe4qkBfLcj/OYCfvqUGbEEVnCjQF+MQ6XyBUkP4H1T452NzMmrmOVXp7W9Hff5pSYJOBzibP8TNAqb8X0SgdcDtr//vJQRaA9zOF/4swMIj9KkCfeGG8+cOkp5TQ0h9NSr07fgvqfKnb+notugXfBYA754HmPR/e4Emvg4YK/gSfdAq4PnvL9NLrwFeffbfTxcBThLom9/hsHneNBMa2ue/+O7t19/h2dunf+XOzyUEOgmgw/SZgCn/r5Zk/3QAtZAXEGgV8PYpOX9+bobqgNvGCfUafdB//Pv9P9zY/ptxJH/ORD006BvaV3z8v0XaLyHQacCSIeQZ/sfsny2gOoD+v4BApyNYUAknA9C+LAAcJdBpO1agt6HwYz/ls/+i39pYYP+rvYRApwALjp+zgMkAlvRxTwa4o/QFBDoTAY5/VwHgjQWABxRo+HW5Yro/b7/+z6+/E2+el50JwO0SfS4+wGkBLMn+yYBbP0F9rn7mIpgdyZwMwBsLAA8oUD/Z84vvXGFfUbZ/+vb3/rBwuT6oBridrdolgKp/vLEghFMBzi7WBz0jgpMB1BU9qon/QrXrrmZyg7oGv663T90xLRzZLjKKrwF+/GrJ8XNBA1YLgLSDmb4rAd69u8yZpHoE1EM/f5BUB9wuS9GDCjTMkbkTg8+pyxaO+ZedB80AvoW83DxoEcDzBe3vWYB3FzrVeWYEZwBeLZvHelCBlvbjv80mXRR+hYCj/F8dsMYMHQlYmUBvl7W9vvArBBzl/+qANWboSMA1BWpmdrZdU6DdlY0A7Wj8PD7qhoEf9T3/27aHw26/5yf8Rny7pz/xGyVAmATQF9x37+7aVgKip55fIHfxDQ/QgguA4D8A+r4P/vr4IQUwEUCXBMAuBcD7rwJ6AFpvMxkSgCyAPn7EV4F84+MW6ND3+9GQnbZ9+dI9ksKQcnMKZmFqEu37HVWQEOh+GA6j+fTf3cVPpt8b/3IhOLuZRKUCWHIA3N2x/+7lSwUQ3bElgPxDDHDWDOSfXkoB48vDPCAGkGt4DpD4LwFlhmr+exNokkYTqAn0gtbstltqkSg7/P/4N4oyNtghhVGYpTz9K/HtZntz03XhF5A7ld88oAAx7cJh+JB7K0n/5smTrjukDWTaOfCfpgC4bguA1E/ydnPz5MlYtkPaBieAdhrQFYBhKAD4bi2AElBmqBaACZTNBGoCvbjFJj4072M6DhimuIeu6qm1obyOLfju0IVGXlp4BS0TZ4oAaOKp5fEfoRfweTRH9KVQsfSWbMPZfXioAhAAf2Rs8w+97zK4WnX+PeDuLh++BHcREGQmA5AA5yX4rwL6KkAGQOVNAN5/DSAVqACSAD5ygfp/02FkOMCxQPlDPiGk31w/mWP+bNOzJwFoBSB2vrzu6X8epUZ/Xg05YEw/PpYF0HJ1OUD+HfpRZvUb1ZN9uAnHpfIIGvRTBSQBZAd5EUABiAFUAEUAOSB2VE2gnQm0BkgCMIEeb43TA+lQpsG9iJZ0t4uDSd+2IpPU6Izt/YEb3MQtJw7pR/MeGnhOM74pugvUheCqQn6pYOi/ZgLtg3nA3V1sf3OACCAHUARh1lUFxAAUgPdfAyCAw+F4QBZADkgDUAEiQyZQE6gOWJlAn6i2coGGIeDNDRruYDEj6QmNlmthtyP9kn4oQ4nM+LMR0HU3N6OfwVkKEDN+SH5azVQsV7ROANjathmk/xogfpcGGxIw1nAWQAoI/muAQQH0if8DDQtjgfAhEQALSwCiPFVAPw0Q/glgAjWBmkCvZAD0/XaLdgKJGPIBQ2ZovJJOQW6cLAZsNtStZ//zAPqLqZcwz1eOgegVDyD/IoBpALtNJh9jE8njC/f74CooARMI74ECoJ9xBdAmABwhPGBxALtdCnBfSwI4UqDiInj3kHZh/PwHE2gOoL8m0PkALi3QsP0iP3z9ZSLIDy9Q7m0nL6MdrHwHbTglP55TQq5cG03fhXYpR01YCpQg0JZNAtDjiKdUDjxwYACeR0DmYxaAdn30wgFw05wAmlaXogNU/PtOwkEGgPNAseGNAeiA2QBI/+R2t1MASYaOEGjcfpEf/uPfTaA6wAT6AAIV2y/i4c9/f5YI8oML1M3j8Gx8yBRVUnk2M1h+Hh158m0yHPGHGjeDxVNMoSbSjn8V0Atr+Yw4G15u3AxW9O8Rs4ACQRXNJ7sFwPtPADg5O+WfAUkAbQboJwDtwgCWAGYEmqxqzvug7//8h+aXUaMm0BRgAp0L4AICTSWXCZS2aHr/l/rmYfUMXMaasV64TjEr7p533XY78S0ETo94Fp0b+93uTr5NABonsC4PhwP16unpZjPxC4jzOFjH4gVK/jGfEhE+AgRAiy6OAtA5Q/bfQqa0SkMgyD8HkAJubur+I0AEoAL6tAo8AP4nqiALQAIy/+cJlGxq+8WJIl7ETKAm0HULtIsN+zBst/s9NSx7KAEDpep8h1wuwmOqQhME4Podk7f3RhNbNAqaaiWF0H0VlG8EAALYeQCpGPNCEwBuAts4L5MC3HP4Rwj+1GgETAfA/kWDmwFiABApA9xyRMw7LQkgByS/sO4sgb6mXZb/+LDzoCZQE2gmUMwtuYcvmsntF+vRX8aajiQZr0nabl3ffL/fbmmZCCXs5cs4FZwZTz1z+1IBxIuedvBPNbDZ0GMspwiDMw0QGrB6BKM/VPDOAeiFu7vNhiTqpoxqvzFMlIkGsu5fAPD87u7mhv3fVQII/sXiuUkACdUBvP9jASIC8RM+SqDTZgItASbQSwn0RrW1C5TnebHqgOQzapNaGLT38SwoZj66/Grt+BhT3znAJY+yTMk/kEuSJnXkGYCBj/9cVwG4fxX/I4B+SexfAHB20gG8/zqAW8NKAPgJM2C/D4AsgBLQJ1YF4CccAVv4p9UjAOACkADQLpivA0ygeGwCNYFe3JqwjQfadTTALc5ajmnaxjNuh0Mx9YR5IL4ApALgtWMu8ehQUP8BM0E3N3zadPwbp6NSAE7pVQge4P1v0aFgAFXA+EXEeKgADt6/Dmj8lLkKuHFXZLIsFID3fzQA/tuWOokTADTtDNATZAI1gZpAr2bNQE08PYJwSIX7/Y7m66PuMBUMJXb4LJ9nw3M0Pjpgjz4EJLRDDeBK/OAuAnhSiR8lgNy1n6VhAOoVAQDAzV3L1cstMQNCqalxzQPwjSb5x6ptjGQiYPTIn9UBIityVVxC6DyAx44e4P3XAd5/mFqqAsREvQlUA5hAGVDkxgQ6b83Y4Ucrvt1iLOOEAgVCVjT3RCfg6AOuTnnUxBLJGq/0TQLAD33fnfdEIzkEw/BsBPBpAVzEENOvAnhUgAjYvwJwPRacQSQALlRJAHnrKwF9M8QAMFXPI5no3wegADiANOsO0AcAxkIJIIbA46cEkGeoU/x3JlATqAn0NNktt2bL1xmQDvHIz6fzR+gDtIETHrUttdQ7hI+/eAuXz3UxM2jfmg0PknY7t/qBXsR8OtcQfY/e8m0+5qZ5DQo8uV4AXk5PDdDeTH6QtNvRJk0lYKxj8o+fHgBYEhMAvFIQPQ0Owi8FlgE8ecKdGYwf2f+eRjMpwPuZAvgZPgKwQL/4wgPgP/7GmB0AMhEFoEsBJlATqAn0SsYX1dImnrw2JGuVIFCaN2aRdpAV1yNexpecGniBCblqgkwcILZKqF76DnnabMZmid5C9wLVzhUAQJiJQS8gAtwXsOqad9hCSIFMAkWbGBwNAoCXZYvK17qNNdyET+eA8QsxMgkInjgA6GcfjHxsWUEpwA99vH9vDID4Rk9c0grA+Y8AE6gJ1AR6JWsGnmCCJr1oqL2mJGAJW5SrW5EHecmrXfm0pas++od68/u9TD8AwTBrhbcEgFKNFyEbLlLvSuTbfhWQ+e/5tKf7WIw3lpQv7O2F/32cUMPfsWiNd1ICghDj7DkWzAWA8B8W6gUAJpVolMdnLxJAHIrlgDECcNsagAPwgI9aoG7aDccECAcS7XAU4QOW7Jm5BGA1p5ys5G5jODTi993skHqfSPYP9wSI1xl1OAJBgxiw8kHWvco/Ca5/BvhTXH0AoCHgc9tjLUUCA+REb89zlxHA0pP+A8D/EAHA4LoVxhGMEPmtHLDnI6AK4OKXAPIhAlAB+xRgAu06E+hHINCNaisXqLsgJt05qOt6Pv+OVMeBr+sC4VRP7I3Fb7ptifA2ZLnfN36ZFJIoyBFAb+FqKHc+B4qNLZsoGk8N5AC353C+4JJV5AAHfzVUuPbUt+DuBFI8XxXXVAaA9z8F6CuAA/zHb2YA8n844Lp4BZAEkALSAKJAHQD+3cwyACZQmVITqAn0gtZsaQ0oX8CDxA3DJr0qHtNvPCAIL+H0tdyC2SUVb7OSmg0WmWLntg5Dss0GIzAJ8OPSOPba+5PsCSDWRAYI/h0A52aE/zjEZYC7J5mLINnAOKrCTxQUAZQA+nQExDVfBwz/4np4ryDv3k9ENDcKAP7j0EgFHDKAT0vwzwATaPyoCdQEelFr3FmR3hvytN+70yZSd9whd2e8+cXYMsbL2EVPAbNRtH8wTmaTueXuNGea7w7nZpfiCW/pA8OGMH6I7SBGYgmA6k8FxLkf5YJ/vjoyAuIvYJ8FkAKihwkADw0LQAyAVq0mgDwAHrHyfNQEoM8C2B8n0Py6+J//9rBXdZpATaDSiu0X//El/fdwAu1YBaRInBbZ7bbYWl2TaFzEmeUnTjr1PNHDAoW560RpWmm73WzyXfGpAgZUUHyJ3YcKQNIlAPXr/eOKTgbI2wsKBZUBRP8CgMdeoBKAwcdm4+5lFJ1MAHod4P2rgI33fxIgDeC4QVKx/SLtKiIOqiZQE+iDCrTYfvGNF+nDChRVzl3r3e4OY4l0UwtMOIXX4iAhTp04mdKDePay6eAc5yd3pFI6sU/z/3Lzeyc3fIpf4Hlmmf5Aws/JDQH6ACDXMNy5LQFQdGn1CkDWRPYR0An/w3abAbIA/CYDAlAEEAEcigbYwL9MB+uZS93x1VoFAP/sImBGoJPbL5pAo3sT6MMINJXc6gTKd+vAlqCw7EO87RLfdda/GAXK33B5Si/0bHqsEfeLQFT/rHpM8vCLUqDuK1GgfKEnC3SUfVw+WQkAEzwigBTQJQC+9xBNM/VoexcAMF+WAGIA8mSyv5IUMeuAfgEg3iFJWh7AkdNMJlAT6Mck0DUMkrAyg7JUSkdY5U1M+yQXImFin9qYcZDUYTE6A1SB+u/q7lGnh0MvtNoxAGOMsW1M/NdKWuHCv3SPgNydyr3/LU5nnALA0vx8X1P27wdJKHsAaH64yVYsAWQBnDkPuoJpJhPoIxHoVrWZ7RffP33g7RfJ4urgCZt8O3bJg+EEXiOyVpUmAyoSRR+kzasOE9cNvzyl/ekA4J+XXcgI9nIWaAGg8nYFgBFPDphALAPElz3gKIFOmwlUe9kEehQgvvwpCLTHUIPntMW8SbkRnOohXbwsjM7IjeH7MYWfc5bzMspOc9OA5G266ob+9wC+U/AEoFa9e1zon4sDgA0HoAKKADTAfs87CaTu4X+Di6pUQH2zvwpAGE1L0fmK2Mk0gaZmAhUBmEBPtKbLFx0H4wYnziaFt+JUB2bDi29jjpneou076e100t8ZX74ZAPHbEoDZdXHaFQsheE7GAxT/EZAHUADSs4cJoNlh8KgDhiSAPn7fXbzGD8XkegQM84AhGL4lAHyJvQrAKZcAMIGaQBOACfRy1nRycJPkCDPb+RfGdGBSH+nHlW3ye/u0qcQWzgGQuuIFDbCez0cit6kOo/99nPAn419AGUAK4FOjWGpNPnANyzBkAuVlc5r/XEUygAhIIhgUgEOoASwD7GWGcHpVALz/gDCBmkBTgAn0ctZkGRGNdXpektbH+bN8Yc6oRwuXqjiZbaL0yx5A8iYD+HKIA+8qEjsXMKlisTya6zfpYqSDJAY4450ccvfZ4uwMkPlPAYn/AIh7mmgBFIBdFTAogCDuQViRoeQnbAKVHkygJtALWtOhf85LgOnq19AS8/gJLYvcAqfr/BnMNPU+q3gbmW38Ij2fxru7uGaPvhvTuMOpUR6xoQqwzCRBpNU7AnY8UnHVhNthFABseJeL2wOyX1gKEP4zQCsD0ABDDCAXaPhYqwPSS44rgEEHpAIVi0VMoM5MoCbQy1kjGl2E47QYs8IRY487MemNjWuURh455BNvTTIA6PO0402/3RWWSnBRcK87rjjvmkchWKGWARCAAuDttDYbqR8BkNf3ZoBmGxORXlGX5IgBUv9lAAIwhAAEgCPY5RmKABGBkiEg8HIAfNQCTTqMOFDu8xND8U41nfw0fr5xCs9f68j7psJDCvCyzgH4xScLLXGEYJm7CkD/y9XfLlZf0ycC5e2MZJBt3MhQ/gIAcJWICsZ8YutrOPhPAlAB+cg/GvyzghJAPw1IAmirAJJYPPpqAZhATaAfiUB3qq1coGIZOw9D+97fR4rn1spbtHiL1Y3vO5nx9/AmboWIj7uBOl/bjbWKeDkILnfO5orIc4ppRw8AEQCMAW0uaM19n84pxvNg41/vP4yjGeEAfD5HAuQvQAFAQkP8xVQASQCJ4BwgF2oCEP4HcSbJBGoCNYFe2Bq3Wpzvm4V7QY/axJwntgHBTp2TFk85uU0xcYIeY4Fm4PX0Ls/UyYf20WjRc77OUXXMFrbIRJVxm8YAf1urnQIYI+CmPaeI6o1bcEYAVR/7dwB6gVpUAQAvl2deeh3g/GcA0uVY4jRDhTwz7ykgC8AEagI1gV7NqIcuL+QmLbrmJS5FrGiHLU5aismmuIU9jWHg1gHQ6NC1WvF0S1WecM8fS2ZS4ukfWq85/p44AK7VdEapSojekxVTAkD6od+rBhhiACpC6geAuMtdEJQK8P4H6b5ApAIVAAg0AEygJlAT6JWs6VAbuEEqDz+G9OzwhOGuGWiCQg3LPT0QARqxVnbekW75v+oe9/3ATT3Etk3kIQHQmvK2AMxKlF7fonQYXUSAf8YBlIAlCOd/GwLYs/u2DT+IHCDuEln4zwF4cZtHwKMlDzCBmkA/HYGG6+L9xqBvvmqaz394UIF2PkO406GfM0mnlibkGlvzcP9ruYdTBPg5ZMoJrjSPCa8LKJz8G93HzgiqLwPAP49j4lXyoinU3YvxCwLg6SY1ANQq8eNl+NP6wdw7goiAoNYIoAkmD6j4ryEY4COI01kOcIxA4/6gfseG118mgjSBZmYC/aACjfuD8p432MNhBQLFhP3eLYjvUoHydvQVy1eEOv3wSxLQ911suKJAMUdSU2inrEbBKc8MwAHkgD5ubaK7L5e0ivaxk1WgAZzFmaDSe89zbhmgzFAEDJn/Xk41qYBkTVYSwKxA5faLcX9QvzHTz39/lgjSBFqYCfTKAk0llwn0/Z//0PwyavRB1oOiRcaty4IS5SI53JBowoucyc+uz278Nnj0d8xxepoSIAZUTwckEuJ7tmYA7z8D+OqDf0U/3n0iUQDC8yyAIV+v3iOAqNzSuw6oZMgDsnWrdIV7/GkU7rMMobUPgHME+uZ3z+7f/+Uhd7czgT4agbaqTQuUHj7s/qDILv2UoMqQmpgA+pf3qFdNu/wzALCwFt34Pl7rHTPLZymHoSJR+tj4be0tWrLv1pyBQC+la+scgNA4m6hKtGgiwy+gDf49Qi598wBeno1lbxWJplcfBP20CYAQCaDPAOpvgD8UADUFHidQsTGoCdQEuj6B+mmm17/6/v7NHx9wHjRIBrfGDPWEmQ6afefb8mCHpIqJNoa37UBji+01+S5yuzijE69WAHN8pX56wFVBzKm8aN5HgBVquGwnBYyv4ylmnyqz6RjYsfEqtwG75w0BgEVwCWDvFydGQEWiCmDwALlIMABEAP73V4mAJVosGIGHEwRKc0t+Y9AXzYPfyMsEagJdag92nyTupYf5YwqZpMmT10jf5AlQbrTD1HgE9KKW9/HTqAs0vWPzhWVrE87zho/MA4L3Pc+F05s0thgjoE9Q81gF9MI9EAGFPahZKnsfAbmN/g/4hWJybmLRyJBaDCAHtN5/BVAQKgAgTKBZlkygtcyYQI82XHKGW+2StbxREMsMAwY0z5NTTVUAskR3o/T+8QYvVEbHwC2unVmiEn4A6S8AAARAVctdEr53UEsEXB43ubSvV80NI3sF4K7TSAOoNvF1906gUFIGwHUgPoAsgso52xrABDoJMIFOuDeBzliz5dsYYzIY9epuA5fOakysiZsBxDZ5s/EzIfsASKZ+Fi/ySwC8Mpl+ZTxIyAD4JG9ccqJ/DZAGwCcJKp70H4AAkEg9QM9QOAtxBMAEOgcwgXozgZ5gzYFaFjzG2MAtrcVqAyQrJuQkge7ldjADL93FfLqfvfeAk/STAoaBl+5iWBcAzv9pAs0D8ACXoiyAaYEeB+AquADABDoFMIGeBjCBovBtPvJxIsVEPRIW83OSQIUqQh3g5CpPhTDgRIHmq0PIJabs+ZShvwLlRIEWq0946nwExAAi4Gj9FFvujQDM2PP94eV13CsTqJnZ2TZ9tDtPoO+ubAZ4aP8fAGAC/ZQBH30AJtBPG/DRB2AC/bQBH30AJtBPG/DRB7ACgb76xXfFS34A99e5wp8KePfudoH7hYCaf+3lowGq83fvfvzXf7p35yhn+hcPrgL46duxGv40DVijQJ29ffrbua+eDrgdX3s1r9CTBfp8fO3Hry7wC9Cz8/bpZ//0b9bSdwn/4sFVAD99O75520zW83oFejuTmndnCPSnbykpzy/zC1D8v31Kh4XbX//P2QA1O+OBE/VLlMkozvIvHlwHgJ/wdEU/rECpIfwPiuA5WlyX7FuX8R+/mj70u8KfCriYQCv+USvTB7d5QC07r5o/vVpYv2f5jw+uBXA20wY8pECfj6V8Rb0oKrlrdccXfvr2r/zenJ0OuFATX/PvBXoeYCo7EOi/fMcPr+I/eXAtwFxNP6RAcQQYu2tvv/4Oz94+/atPOxrJGTsDMDu8WAKo+vfHtrMEOpUd1O+C4/RZ/pMH1wLQ4XQScJRA8+0X/T8nCvRV6Om7cvpGAD23Bc3jvEDrAPrVLuhEzAAm/LtB0lkCncrOJQQ67z95cDXA9BjpOIEW2y/6f04U6G2IYOysfPZf9IMby/3cyeb5/ABjXqBVwJLe+QLARABjr+uz//76nD7oVHYu0cTP+08eXAkwc/w8TqDF9otig5GzjqBOL+7P26//8+vFLfzyI2gOWDqIWXoELQMgm5tDnAZMOr/AIGnef/LgOoDbOX3OClQueSq2XxRbNJ0iUJ/gX3yHBovagJ++/b07dC6ZQ1zaB1UAeGMu+Qv7oGoAZOdNM006f3X+NNO8/+TBVQBLeukspl61md3tzhOoH0vjJ/b2qfsx+Z/Uoi7oglmgGuAyfdCqf3eSYUkMU4B6dmT/7vSJ+nn/784S6Dxg0VTiQwo0TJS5E4M0sOBB3oJZ+pnszACez55jWwSo+R/r4/xTndXCixbynFOd8/7PE+gs4Bbt87J50AcRaGk//tuCwVEo/AoBR/k/FnCc8w/g/wMAThLoZQZJmt0uGRyFwq8QcJT/YwHHOf8A/j8A4CSBLpxmMjM7244XqNh+0f9TE2jYjbScHgjbvUZW297d8WZcft8Uvh4zvsKXEru3JgBxO9kM4P0HQNyKxr0i/FP4RwGSAHrpRw9AAuoZaqWHYwGTVeD91wCF/yMBQw1QDUCtgqMEOm2FQIdhuLujkFHSly+55GI34lg2tiQbmoZj6XSA9B8/nfsPgCRDif8coAUgypsDeLe4pAZUwFSGygAyQGLVDAGhAJQM8SuK/4WAhVUwH4AJ1AT6iAV68+RJ38fCy/JmhceHuAkJ+FSe9BbvlIDSPVEB+GQVIMMvAIl/HdDqADWAHNDqgDJDhUArGeqLDCVvVzLUKgJdXAXzgMT/kVWQ+TeBmkAfsUAHKhXKxW1L19Ervn5fvqS3sC0KCoe3RNG5+Bx++DD9qQL48wogHR4VAPlZ7FFfAO50gBKA3DSHa1AFVDMEQDVDffSvA9QAGFDJUFkFCmA2Q7zr/6IqSABZhq4p0D6NTP6g3Cux8yV7KjzIE/rJb/bnP6sBWuFfBwT/NUA7BWgTAKW/HkACkCXMAVkACaAolAIoPfgPVzIEQOJfB0T9FICFVaAC8gCUHAeACdQEWgew+09XoES6u4ul5Ir0XZTYU+FN0lou3W53OOCWAql+ZAdIAbSJ/xLQzgGSDlAJaGsA3vW/BlB+igGQBZACumlA8K8BKhlynVwlQwmgCOAIALa5qwDKDBUCLRXYDKqZQA+JsN8AABHESURBVE2gpwA+EoGGW4Rin1l2KuQpR3u8WaXXEe1+SoU/HPA8TaJ7qQKQ6ikAHDhuLlUAhH8PwBsOIDOjAJIAcoASgASkGcoAaoYYMJGhPg+gBExUQSVDZRVUACdUgR8kJRkygZpAH61AO6kePtbLezsr5lu4uzu+vWraAPi30UY0iTwDYIn/GoDfZoBM/lEB5IBWWAE4JUMS0NcAWQBLAMFD9M9iSQBqhhygnQ4glBAAuRhCy5AJ1ARauH8sAm1ZVqmhKagUH4f3A5oA+kvFl6dncbLWPS0B7vkC/zQbLU8FC4D3rwOQtFMARQCXBSgZahX/LAAHqPhnQDVDBKgF0J6eoUoVmEBNoDrgMQj0zlmaG5yorZZevaMTlZVP5YYmgLKjAo73/wEAmf8UcIUMtVMBtNP+T6gCEmmb+b9MFZhATaAXqIKPU6A933uPCk9h4M5O1KWuJydM2fe4sTMXnpoDNAvBIoAsAJb61wD9NAABtO3xADWAFIAA8PgYwJEZOgaQZwhrSZYATqyC3L8J1AR6TBV8YgLt6J5vfEtCnNYio9uO7vf1TnQXFkFy4HhWNA0VgPc/BWhPAsA9pZBnpavudUBhHpAGcApg2r8OmMrQkQH4ex56wEUzZAI1geqAYwJYh0DFZotvvmo+/8H94/6tCZTuKHo47Lzh/sxU/pubzWZP07n5Wu9EQbHg9De+1/OTCoD8U34iQEFMAFitAFDGhX9UwPGAdHk0I5ruIPyPAFbQkycBoPuH4+AfE94FwPvXAdMBtGkAOqDPAUGiIgAd0NYBpwo0XgX//um/378YH77+MhGkCbQOMIHWA1gk0L1qUnNiHxHe84YukZ8QaIu7Mrct3V73cKDHdBtcmvVwpedON8ooT8Z1+SGfFhQUGqgAKCPIjgLgRucUAPzTSEQBZAHkANU/A9IAAHjyxC9+q2RoESDPECECgBfX6YCi1V0IOBzyAPQqKJv1DOB/wssFKnZi8g9//vuzRJAmUBPohxao2H5ECPT902/uXzTfvP/zH5pfPpsQKPcUkHi4pECocO5yQC7T4ZA1Ayg8hjzVW4wzAA19ALD/L76IgNDOgMLZOQ4QAyCEBISrOqWR47u7BYA9BxAlSoAvvnAA778KuJv0T3dt3ycA+tcBvH+/2E0BeP93Vfc0UR/FAkBo79vLAE46gtLo6P/87Zs3v3t2//4v9c3DTKAm0AcS6P19OJhObL847HZcwVRqaIiaBHEwZ4FSECg1XVHlC09vUaxKwckqACyB7WoA7/8EAPzDZQHgdiwFEGIegOpFAOy8yFAFUPEPBAegAmQALJSiCiYAfQEg5+P/WoYSQJohLF2uAZYLNNts0T80gZpAVyJQOc1EI/gv71//6vv7N3+sz4MOGEkMw3ZLNExCJP7pyg40CtRzplLiGoBd1E9qPmquXglAIjMAHBIAj9n/LqZf858BqNkN/lMCAHd3O0q6CGAOwPW72UT/OsD7LwB+pVolQyxQ538K0NUBagAR0E8ADhOALIB6ho5s4nmzRZpbeo0J+hfN5PaLJlAT6IcU6JwVAt1w87jdfvEFDuldRxNN1HP37cJu9+QJjvpUIIjWDZb44I8RFF4OoyjEVgV4/77ll4ADOZIazADdNCALwAPcW95/BdBlAbgfYwDAP6qMAWzsXwE4hPffhcRJQBoAA/iUBvwXAKEQEYAfyCb+x1HYJg6Cf/Mb31Qn/jVAVwEkQvUAE6gJ9NEKdIi1yKe1cEAPAqU3njzh0NEwuHjTwscC0Qd9c9v3EkDPA0DqpwQ4qwCCf5efJvyOHEAGwNM3+AW4L6YlTQGHGUAWQJcI1PtPAKEv4v0LAEncAxoxyVQBHGoAVhAD+C0HCAEkfjwgC8AJFN05kYqDAnDv0YsiQ9cUqHeCHmg00VHElCXPS1IvBRXfxiNQ/Dx+hG4egIKO2ckAsiMqVysyYM/HIPkFHJnY/0kAyug+AcSjqMt+DADd4gCoZ2j8WDsP4HM4lMgEMFsFmLRUAUoAB5ZelwWgZQgECUAHdypDh3AIDwATqAn00QrUTbvFQuBSFZR0x4PrmH4qDqpw/F9+C59HOKFkrn9SA+ymADwVqwLSBogA4tLwLIAUABdtHdAJAFd2AKgZAqCdA6QZOgQrA5iqAhCzKoiX3CsAJUMO0GcBlIAYgAI4pAAW00E1E6gJ9BMWqCsXzhWnywGTheB0upoLz83gIc6SteGjIkMky7F0OiCuM1QA8E9NcxVwOBkgAigjSAJIAfQpmZ8MoGYoAtQMASADqABOrQJ8tgJYUAVKhggQA/AAE6gJ9NEK9OZwoBaF9+2hlYD7PS+0DlstESf2tH0BMU2YX+lNf3exsdEA4zNuxdgUwKEO2E0B+EkJOGQBaADyv9spgCyAHHCYAuQBJIBKhnIA6Qe2oAq0AFJAmSEFwF2DDFBkyARqAn20Au3p4r7eG+V3s8HVlm0bGkycjc8F6g0XC3EzkDSX7vCvA9wOa6FBPg7AiUIKm57W/gsAB1ABFP4lQAaA9I+ATgD2CaBT/GsAPUMeAP88glEB+HT5C5isgl0aQAZIAzgWwEchDzCBmkAfs0BhdHZ5GKiEm9FwI52kAuTkUVL4WHzo0j/2HegEwPm5oVtLCP8nANoCsNmMAO/fAdI93wOg0E8EJAHkAMpLrwO4gqsALUN+PCIDKAC5go7JEA+oVICeoWWAPgeYQE2gj1ugWLax9bbZUH/ZzRdL/fAMPL924JtLlC2MKzs+VQIoS3f03WEacJgC7DIAENG/DigCKAEigBSQBZADKhligJqhnRrAZpMAFlSB1sgXVQBEAFQy5E9SZAFkgCJDJlAT6GMWKNIODXEhOmlxwCHXOYrqjcZjIx9Y2xKA2t4M0FUBnfCfLJ0PgHQ9ZAZQA4gA2XqpgCwACZDuiwzFUZsCmMgQ+yfCKYAyQ1hPWgTgOkDS8gwpAJkGASgyZAI1gT5mgZJEexeEXnZnyKtqaBnS746l327pbBkAcH1BAGVnAqB5adua/xQQAkgBV8gQAFfKUHdShhYBigyZQE2gJwA+vEDvVJvZflG8UhVoapUyVt+iwvOiAhEt+vOLAeiELwe0E4Bq+iuxeUAWwJGAmeqNY4oMoN8j+AKAkzJ0EuAIgZbbL8ZXTKAm0IcWaLn9YrbXiHbRHJWXZ2zl+a9kp7mqQOnMWHatn5v1bTeb3W6zmQBoG8EtA7R1gBwFKQDF/0IAB1AF1H9hh0qGAMgzlADyADT33aEGSDN0f8/X4ukBHAVIMrRcoOX2i9luTSbQUwEm0FoAswKd3H5xTqA7DJC0jcoHtrTwVDC+grzlo3xedt4vaZgADCqgzfyXgMT/UYCY2WMA7hRtX57BrGSoAihrN/U/B8A5TBWgV0E7zAOGOiAPIBFomwJOOoLy9osmUBPoOgV6f7+kiU/GBnklu6UHXCT6EIqFyhO5kaHTM1dsdMZZPyqAV8zG7Difwr8O4MwogLwCWmEd/7omAXsdoGcoAXRTACVDQCzKkAbwEtKrQCBYoMcAhH89QzKE0wZJXq9zgyQTqAn0Awq03H5xbpppR7UgyysfO4mhlLwUaygtqhjxRXW66q0C+FPHAvCZFBAQSgARUPGfAlodMJGhfiaAfZ6hBNBskwAEQKxgmQTkWz4xYJgByAUmWIC8CNAG/ww4QqDl9ov+FROoCXQNAp0zXaCxmrDBbjjucwDYDc1d8R9soLaeLCu8FGjbAoCAIiC53hWpo+UeyXeHGkDmZgRsE4D3rwPSH48KaGuALIAUoAYQAbH95CZaALIAcsBEhtIqKAAxAPo3A1Qy5AEDF78CkAIdAdcUqOidgIbi9LHYZPS7ohkvKdBtHOhy4fmXTq/5jk8F0M8D4gqoDBD8a4AsgBSQBVACWg2wCX4QABAZQM1QBHAFKwDhvwTEw2IFMNQBMgB5yPSAfh6QZyhYliETqAn00Qo0lBCFR0ckm/NKexzCYgBoV8hC+fGRCqA7DhC3zXOPkB8P6BKAEkDeJ6sC2D/5UADVDHVt7LdVAFkAYZpV+OfmtlIFlRzpGeII3OcrAOn+OIAMgCwI9KVqJlAT6Ccs0FZ2+CkviBH95X08oMsyZ8voWaAxP4MovA7w/iuAzDJA4r8E7M8AKAFIAO+QWQCkoHX3yzJUAGQAVcBwEqDM0HJAliETqAn00Qp0Tz1j3LSJZpJwG69wxKcuc1q53CxkAcQ9PvH9AfMTY+EDgJ4HALcoJcAhyvwIgPdfA8jGTgUUxU8Bex2QBZACJuVfBJACmj224gQANzcIAD1DSwExAAUwkaEZQJEhE6gJ9NEKdKDdRPjcQpTNZhMO4Jl2ukKi+Jhc/eLOFuNBCUBSov8sM6V/DRCfKIAsgEH1n6d/nweQAYoABEDNUea/zFA9gGmAnJNKA0gBExnC9jHDFKAUaAYQGTKBmkAfrUBdoelYzbv21sqcqicmiCYheNsjvA4//gr6CYDifw4gViRVADMBSAK/IgBywRCfgPYA3BzwNEAaANevB8gAcsBMjsoA0kWcXj/HAsRpiQlAfGICNYFOAj59gZLhJkToRlPJs30oqvpB1xt1idnfMBUR9aMAVP8pIge07i7e7L8CaCcD0HspAZAEkAO8/zmA0shnAaSAIoDLASoZauf897n/FMDyDAATqAn0JMAnJVAsro7nu0Lp6WmchlAkyhMQ/Ko/+uNJBSD8ZwBlmJQBZANfAJQAckApUA/o5gAyQ7J+awF0qf+ASAC1KhCAPEOFglQAP60C6lVQDMMSQNoFMoGaQB+1QKlsuLyPusLpal1f9M0GURUSjR+JucFYqI3VKwFYDZ0QGBBfKwD0IQFopwDxJJwCqCmII2iTAEL9OkAMIF8ZUgRQtMGof3YoRzJqhjIAAkjPRRb5KSfqA2ECwN8tAGUFFBP10UygJtCPQ6DLNHecQFveH5SsmEZBkbdbOj/Gxe+kcfHl/TbTwicAhDekJncozRV6AqC8pkYAdIEuB6gBDHkAU438ogxlCHwAM+tVicZxzBKAlqEEkLqfBphATaCPVqA97vpAFgMQK17pZV5jMDlQStuYMFtVAcQVtQxAfioCTQA0ZbyrA1oFgJ/YRgtAAFAD+KYKUDM08OtbebmEIlF2mgEWVUEVIBWkABZXQQHI85MBkgwdIdB0f9BfPnP/uMuPTaAm0BUIVO4P+s39i1Gsr7+sfvge00x8nOcgkB8q0oYeYOqXCl5eaFUEkDUcuN5ABTj/G8g5A3RLAfQdBdDWAMWlbilA8U/pjwAlQwDkGdJ6ETUAXRSTuheASoYkoD8ZkGeInofJJjWACmC5QMv9Qd0eDiZQE6gC+FAC1bdf/Plv39y//vyHn//+LPlwIVAwcPNbKji3MOKujFhpUGni8xAyqwL4zjsMwChD9T/hvgAUAUiA1gIvBVQz1JcB9JVfwHEZav0tidIMTUzGHQsoMySGScsD6I84gsq97Mbu6Nj3fP/nP7iuqAnUBLougbo96n/1/ZvfPbt//5f67nahRBQAD3MoCJp52NN1AvGq/6pAJ0LIAUBE/xrgCPcKIAsgAFq5c8/RgCELIAV4/3XAvH+voQzAAfAyvQpgwn0FkGeo9aYKdA5wkkClVif2BzWBmkAB+CACVQZJMwId4q15eCIBnWj6u+NNZNLsKAJNw6BH/qXGtSwFQK53LQBz7oWlgCEPIALa+QBq6Y+AoQ5o2wn9TFZxEcDArssALglQMxQBi90fJVAxzfTz31wT//pX39+/+WN9HtQEagL9kAIV+4P6ifoXzfz+oNHQjcasrTsfhqYAaylmBapYCkB+PIDywwDkZ0agVUD6CxAB8JyKB5wSQAoYdEAWQB2hvK0EkAOKDNUAhXaqgEqG6gJV3R8v0DkrBGpmdrbNiOkcgZqZrcpMoGarNhOo2arNBGq2ajOBmq3aTKBmqzYTqNmqzQRqtmozgZqt2kygZqs2E6jZqs0EarZqM4GardpMoGarNhOo2arNBGq2ajOBmq3aTKBmqzYTqNmqzQRqtmozgZqt2kygZqs2E6jZqs0EarZqM4GardpMoGarNhOo2arNBGq2avv/jLeZdYBNqVQAAAAASUVORK5CYII=" /></p>
<p>Now to compare the final day with the vegetation map.</p>
<!-- note reduced fig.width & fig.show='hold' above to fit 2 plots side by side -->
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot vegetation map</span>
<span class="kw">rtPlotMapVeg</span>(mVegCats)

<span class="co">#plot final day</span>
<span class="kw">spplot</span>( raster::<span class="kw">raster</span>(a[,,nDays], <span class="dt">xmx=</span><span class="kw">ncol</span>(a), <span class="dt">ymx=</span><span class="kw">nrow</span>(a)), 
        <span class="dt">names.attr=</span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;day&quot;</span>,nDays)), 
        <span class="dt">col.regions=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>,<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>))(<span class="dv">99</span>)) )</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAb1BMVEUAAAAAADoAAGYAOpAAZAAAZrYA/wAiiyI6AAA6ADo6AGY6kNtmAABmADpmZmZmkJBmtrZmtv+QOgCQOjqQkGaQtpCQ2/+t2Oa2ZgC2/7a2///bkDrb29vb///u6Kr/pQD/tmb/25D//7b//9v///8yhEKaAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKfUlEQVR4nO3da2ObOBoFYHfasJk2s11np3W2nuJc/P9/46Irr15JHOFL6sI5H2ojiIOeGgFCkM2RmczmV6/ArYdAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIJAPa3G5+hU8BqGvObrdTk0mGor7vh38Ph4Ms1Mvl88qfR6DfBMiuTG8jq59MynoUgQqWTUbSlUAEItAqgT6ZOCNdzUagsuUUSu5HIAItFijUMVYzb4xMJFBcYqeOYdy8JiBFrT+GQARaFlC+0p2qQRGosJCLPNsAOtWPIRCBFgQUKw7qLktqOIXmZWzHJoC0IoEItBQguZbuqLqwukqnUNFYVPwZDxSZpmjcbAIRaBlAJZ1OHd12J8RVVB50l7U1U5wmEIEWBzRVWWnWRKManEQn72Pt5PG5K7ouUO0SJYH+8fX+NGYZQM9//Gip//Nm82Vi9tvjl/lAfQiuchOQ5sjjlgBH7acBPd1Nzl4o0OvD5sPfA9Db42bz8efx9a9v95sP34/H/ca++GLrs9n88cNPv/3372F2mGmXNRN3ywMy/+2vD6biw3///uNP8/749PGn+VI9j8XhG/T2OBgMs98ejZKfKZedB1SqdcFr+JxWnRzocDgkM+QbeRKbZFxVu3UN/9jXt8ft68N2nPazh+IA9PL5h/nSbS1GmOmXXSaQ/XYM1d67nfKXAGQ2mK3deGxxAHo2iw8S1izM9MsuHMhvRgHIeAwNSyguA40zn2wjdALQbqILJ3bkyLPYU6Sm/BBQsomlQAYi2b8lm9g23flZtCUCmVbXNdLD1+H5w3fZBr38+T0UB6CxkbbblJsZl10ikNmPx938ABG/QcNO3TUsbnfvgcJu37XbYaZfdj97Nx+uGuY73cToU7iGv1OHvS1GmqbJ6FbOxVYKVAuBQCavzceqaDL3LgLtxP5Z1lt3JSXz8lR38O8BNGcTWyfQv8YsAOifljo3LbRIIHey6s61Xv/y+/NYIha6ElCfpWDkIpvqWD/QYMeFeiDSBDSGQGPVN5u714evtg/IfINe7m2v0AD0cn/nDwvHnp71AcX+IHP+MAD5nozh5eV+Gzt8rvYNChc8c6Aunmr36VXRHChpwbpwP0uhDSoUtQK504sByJ9/vj7850F0+BAoAvkeDNMP+112+BBIA21Nz0/o8LkikGpxZE3y5inRiD9ziCK72iHARMptE97E7GYVOnwIFIHM2/2dLXn+EHuD1gxkOnEEkNnND18bW/LkdvCuMZq1m59x6Vm1PrH3WUoVqOSihzisNfoV0oWrPVWUuNDuds7mCZR6ZAUESj2yglLFd3n7UQNKrujkC5WBiguNv869u5X+oNUApb0hclTLOoBax72cA1TdJ+dtUJcnXw5/mMQf7U4Cah33skggOezFnZumw2COM8a9LBEoXCq1XR77fBhM+AY1jXuZDVS5bb1Tu/mYKpD8jL62K68tncSVjqsaLrbbY2dzjqqGwQSgpnEvSwQKwzVsf/TwqofBBKCmcS+rAMqHwbSPezkBKFa8LBJrk1dOY0kUOa8KVGCKHwM2sQJQ07iXJQIljXRohMUwmADUNO5liUBxt/7wb7fn1sNgPFDTuJfZQPZg2K3iJ3GvRlz1ZMyCim48urQpkyXlhqvwqfGn8wPF/NrY6Wk/F1spUC0Emg1k10qNYdVeRZ2CkQLSUbPjZAEobYOuATHvbp8VAokVIdD5QDHu4rs08tN6j14zmgJSRhIkkboM0HSLRaBVAfnbnl7u7TGf7RozZxZuMvQKxd6hUO4HzFwWKBrFHFy6YoMh6lMAKpDlIgUdvdq+S8ddKXQD7MOZ2ZMp9gNj4mtavhIg8d5ec/ZFwU286vIVAPkuHTvixXS5DpuX3czcZA6Ulq8A6Oi6dIZ6f/Gb2/8eTBvjJjWQLr8IUOTIq1/NTjWzeQuNm+3404VF01U1tz2Z9sQ1QF8//ziGSQ2ky1cA5Lt07Mt9HMgRJjMgVb4CoNClYy7tmI3raAZvxsmsDVLlFwHqxNnGPKYubVQm06VdajlnstBNnayuD6gWAoE07OZnZyYQ+KF4wHBrm9jagA5jCHQpIHm6vsuPmWXlZgP5voDW8/1OXoypdFyc1UVNoHUBfR1HRptDv72/bjjV4XMxIHEAXUCZgJgCqh1VgyPrXkYCuXFB8mTiGXX4rAtoOw5eGJ/hMX0usSogP+xFPRbn/YFklatGAK4XY+nKFZ9CaQM6hv4hAnkgtYmZstRr9UBhXJAZAxQfi/NuQK0UslqyvFpFnazNmTSSm9g3e5+zvQvz2+fwWJzzgGYMf7l5oPcMgUDqQKrufbhnUHOoyo2Fc1kmgVTL8H4hUKj37DZobUDil81spGXFyyiqZn7pGk2TVjI3X20CEegsIP80YHebkx/dEsbE7DcndXm0A3U6EmiqWjlIOXppNV39PHkk/eX4cu8fNCkHwYxdH+sGslfb9/KeL/Uo4BOyKKD93dF3c4hBMPE2Jz805rpAu+lj4yinsFqNCmDKqLBcBSgOgnF9HuPLioHGTWx7jKNezAy/zc18rsnygMZHtm/HUS9yTMyfK/8Gud28vw8sDoIZx8Sc0gi1A4UBdgfx0KjIVICIM07S6bMWv1fNdpxQq/p84uWLGlDzudhvAGQepn1KO3NKfksgewfz+/jUgHp7/lxsWyrN0rnZZdGFt9LdsVaghvcEagIK6+Naol61CBcF6dO2KwdKSglEoEsBxRudxJ+B0n8xysZ3FaWPxwn9R+cCybUsr/dFkNJP1r+lAiSurIbxLmMfkSxzXUXJ43FC4bKB3DlYeDaHKQsnsLLMJjwrKPmbUXmv0SKBwtNdTFnoApFlY1dR8jej/E1UlwHahb8VX6hcscbnGU38x5wAFLqKksfjiP6jxQOhTSx0FSWPx5H9R0sHkg3y2Ec0loWuovzxOPdZn+McIDdIZhfexBNXUNfYQ3SeUVUtB8p383ZvNZb5rqLs8TjuJqq03s3nYr8BUDUX7iNaFNC1+ogqQF0a2S6UI3/mPKBqwDfoSn1EywG6UggEUu8PilFMY4oLndpblH+2/kUEItBCgcrViIcAqkLxGOHiPUgEItBSgOIqycZkp57UIo+1ZeGpbRCBCLQWoNLj6tUOuN+Jix69PYyWTFdofwhEoOUApU2PzFjx+E62PrWL+QQiEIFkAYFSj6wA1a58yq6MCEQgAnmPrOB28yt8ciAmDYFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUD+D1g9chmSi2J4AAAAAElFTkSuQmCC" /> <img src="data:image/png;base64,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" /></p>
<p>Now that it seems these vegetation movement effects are working as expected I need to add them into the main simulation including births and deaths.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

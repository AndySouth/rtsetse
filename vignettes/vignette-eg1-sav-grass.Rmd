---
title: "rtsetse example1 savannah grass boundary"
author: "Andy South"
date: "`r Sys.Date()`"
#output: rmarkdown::html_vignette
#to produce a pdf
output: rmarkdown::pdf_document
vignette: >
  %\VignetteIndexEntry{rtsetse example1 savannah grass boundary}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---
  
[rtsetse](https://github.com/AndySouth/rtsetse) is an R package that simulates tsetse fly populations on a spatial grid of different vegetation types to enable investigation of tsetse control. 

This document shows results of a simulation on a simple 50 x 50 grid, half savannah and half grassland. This was et up to compare results with an equivalent run in Hat-trick.


```{r, eval=TRUE, echo=FALSE, message=FALSE}
#install & load packages as needed, not echoed in this doc
#require(devtools)    
#install_github('AndySouth/rtsetse', build_vignettes=TRUE)
require(rtsetse)
#these packages are used for plots in this document
# require(raster)
# require(sp)
# require(RColorBrewer)
```



```{r, eval=TRUE, echo=FALSE, message=FALSE, fig.width=4, fig.height=2}
mVegCats <- rtReadMapVeg( system.file("extdata","vegHalfSavannahHalfGrass50x50.txt", package="rtsetse"))
rtPlotMapVeg(mVegCats)
```


```{r, eval=FALSE, echo=FALSE, message=FALSE}
#to run simulation
#not evaluated because takes ~1hr
#already done & saved in /data
iDays <- 300
aRecord <- rt_runGrid (  pMoveF=0.6,  pMoveM=0.3,   iDays=iDays,  pMortF=0.082,  pMortM=0.139,  pMortPupa=0.2,  fStartPopPropCC=1,  iCarryCapF=200,  propMortAdultDD=0.25,  iFirstLarva=16,  iInterLarva=10,  pMortLarva=0.05,  propMortLarvaDD=0.25,  propMortPupaDD=0.25,  mVegCats =system.file("extdata","vegHalfSavannahHalfGrass50x50.txt", package="rtsetse"),  dfMortByVeg=list(code = c("D", "T", "O", "S", "B", "G", "N"), name = c("Dense Forest", "Thicket", "Open Forest", "Savannah", "Bush", "Grass", "No-go area"), mortality = c(200, 150, 110, 100, 110, 210, 999), pupmortality = c(120, 110, 105, 100, 120, 170, 999))  )
```


```{r, eval=TRUE, echo=FALSE, message=FALSE}
#load sim, no need to echo
#may just lazyLoad so may not need this
```

The following maps show the distribution of males and females over the progress of the simulation. 

The simulation starts with female densities about half of those of males, constant across the grid.

Differential mortality causes the densities to decline in the poorer habitat on the east half. Over time densities change in the boundary between the two habitats due to the interaction between mortalities and dispersal. 


```{r, eval=TRUE, echo=FALSE, message=FALSE, fig.width=5.7, fig.height=2.6, fig.align='left'}
data(aRecord)

days2plot <- c(1,2,3,10,20,40,60,80,100,110,120,150,300)

tmp <- lapply(days2plot, function(x) rtPlotMapPop(aRecord, sex='M&F',days=x))

```



